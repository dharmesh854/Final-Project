CREATE DATABASE SQL_FINAL_PROJECT;

USE SQL_FINAL_PROJECT;

CREATE TABLE STUDENTS(
STD_ID INT PRIMARY KEY,
FIRST_NAME VARCHAR(60),
LAST_NAME VARCHAR(60),
EMAIL VARCHAR(60),
BIRTHDATE DATE,
ENROLLMENT_DATE DATE UNIQUE KEY
);

INSERT INTO STUDENTS VALUES
(1,"Chauhan","Dharmesh","dharmesh025@gmail.com","2007-08-25","2023-11-19"),
(2,"Jethva","Vrushik","vrushik77@gmail.com","2007-04-20","2022-02-26"),
(3,"Kuvadiya","Hardik","hardik18@gmail.com","2006-10-15","2021-01-20"),
(4,"Parmar","Risav","risav077@gmail.com","2007-08-19","2025-05-30"),
(5,"Pankhaniya","Mayank","mayank1408@gmail.com","2007-08-14","2018-07-18");

CREATE TABLE COURSES(
COURSE_ID INT PRIMARY KEY,
COURSE_NAME VARCHAR(50),
DEPT_ID INT UNIQUE KEY,
CREDITS INT
);

INSERT INTO COURSES VALUES
(18, 'Data Science', 1, 3),
(33, 'Fullstack', 2, 5),
(45, 'Graphic Designing', 3, 2),
(17, 'Video Editing', 4, 3),
(08, 'Data Structures', 5, 4); 

CREATE TABLE INSTRUCTORS(
INSTRUCTOR_ID INT PRIMARY KEY,
FIRST_NAME VARCHAR(60),
LAST_NAME VARCHAR(60),
EMAIL VARCHAR(50),
DEPT_ID INT,
FOREIGN KEY (DEPT_ID) REFERENCES COURSES(DEPT_ID)
);

INSERT INTO Instructors VALUES
(101, 'Anil', 'Kumar', 'anil@college.com', 1),
(102, 'Sunita', 'Shah', 'sunita@college.com', 2),
(103, 'Raj', 'Malhotra', 'raj@college.com', 3),
(104, 'Meena', 'Joshi', 'meena@college.com', 4),
(105, 'Suresh', 'Patel', 'suresh@college.com', 5);

CREATE TABLE ENROLLMENTS(
ENROLLMENT_ID INT PRIMARY KEY,
STD_ID INT,
FOREIGN KEY (STD_ID) REFERENCES STUDENTS(STD_ID),
COURSE_ID INT,
FOREIGN KEY (COURSE_ID) REFERENCES COURSES(COURSE_ID),
ENROLLMENT_DATE DATE UNIQUE KEY,
FOREIGN KEY (ENROLLMENT_DATE) REFERENCES STUDENTS(ENROLLMENT_DATE)
);

INSERT INTO ENROLLMENTS VALUES
(201, 1, 18, "2023-11-19"),
(202, 2, 33, "2022-02-26"),
(203, 3, 45, "2021-01-20"),
(204, 4, 17, "2025-05-30"),
(205, 5, 08, "2018-07-18");

CREATE TABLE DEPARTMENTS(
DEPT_ID INT PRIMARY KEY,
FOREIGN KEY (DEPT_ID) REFERENCES COURSES(DEPT_ID),
DEPT_NAME VARCHAR(50)
);

INSERT INTO DEPARTMENTS VALUES
(1, 'HR'),
(2, 'IT'),
(3, 'Account'),
(4, 'Sales'),
(5, 'Marketing');


-- 1)Perform CRUD Operations on all tables.
	-- Create
	SELECT * FROM STUDENTS;
	SELECT * FROM COURSES;
	SELECT * FROM INSTRUCTORS;
	SELECT * FROM ENROLLMENTS;
	SELECT * FROM DEPARTMENTS;
	
    -- Update
    UPDATE STUDENTS
	SET EMAIL = 'newmail@gmail.com'
	WHERE STD_ID = 1;


-- 2)Retrieve all Students who enrolled after 2022
SELECT * FROM STUDENTS WHERE ENROLLMENT_DATE > "2022-12-31";

-- 3)Retrieve Courses offered by the HR Department with a limit of 5 Courses
SELECT c.* FROM COURSES c JOIN DEPARTMENTS d ON c.DEPT_ID = d.DEPT_ID
WHERE d.DEPT_NAME = 'IT' LIMIT 5;


-- 4)Number of students enrolled in each course (more than 5 students)
SELECT COURSE_ID, COUNT(STD_ID) FROM ENROLLMENTS GROUP BY COURSE_ID;

-- 5)Find students who are enrolled in both Graphic Designing and Data Structures.
SELECT STD_ID FROM ENROLLMENTS
WHERE COURSE_ID IN (18, 08)
GROUP BY STD_ID HAVING COUNT(COURSE_ID) = 2;

-- 6) Students in Data Science OR Data Structures
SELECT STD_ID
FROM ENROLLMENTS
WHERE COURSE_ID IN (18, 8);

-- 7) Average credits
SELECT AVG(CREDITS) FROM COURSES;

-- 8) Max salary
ALTER TABLE INSTRUCTORS ADD SALARY INT;
UPDATE INSTRUCTORS SET SALARY = 50000 WHERE INSTRUCTOR_ID = 101;
UPDATE INSTRUCTORS SET SALARY = 55000 WHERE INSTRUCTOR_ID = 102;
UPDATE INSTRUCTORS SET SALARY = 60000 WHERE INSTRUCTOR_ID = 103;
UPDATE INSTRUCTORS SET SALARY = 52000 WHERE INSTRUCTOR_ID = 104;
UPDATE INSTRUCTORS SET SALARY = 58000 WHERE INSTRUCTOR_ID = 105;

SELECT MAX(SALARY) FROM INSTRUCTORS WHERE DEPT_ID = 2;

-- 9) Students count per department
SELECT DEPT_ID, COUNT(STD_ID) FROM COURSES c, ENROLLMENTS e
WHERE c.COURSE_ID = e.COURSE_ID GROUP BY DEPT_ID;

-- 10) Students with courses
SELECT STD_ID, COURSE_ID FROM ENROLLMENTS;

-- 11) All students with courses
SELECT s.STD_ID, e.COURSE_ID FROM STUDENTS s
LEFT JOIN ENROLLMENTS e ON s.STD_ID = e.STD_ID;

-- 12) Students in courses with many students
SELECT STD_ID FROM ENROLLMENTS GROUP BY COURSE_ID HAVING COUNT(STD_ID) > 10;

-- 13) Enrollment year
SELECT LAST_NAME, YEAR(ENROLLMENT_DATE) FROM STUDENTS;

-- 14) Instructor full name
SELECT FIRST_NAME, LAST_NAME FROM INSTRUCTORS;

-- 15) Total Students
SELECT COUNT(STD_ID) FROM ENROLLMENTS;

-- 16) Senior / Junior
SELECT FIRST_NAME,
	CASE
		WHEN ENROLLMENT_DATE < '2022-01-01' THEN 'Senior'
		ELSE 'Junior'
	END AS STATUS
FROM STUDENTS;
















